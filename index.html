<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gemini AI 虚构 OS 1.0</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
      body {
        font-family: 'Inter', sans-serif;
        background-color: transparent;
      }
      :root {
        --text-main-color: #000000;
        --text-shadow-color: rgba(255,255,255,0.5);

        /* AI Theme Variables (with defaults) */
        --theme-primary-bg: hsla(0,0%,100%,.1);
        --theme-highlight-bg: hsla(0,0%,100%,.1);
        --theme-gradient-start: hsla(0,0%,100%,.08);
        --theme-gradient-end: hsla(0,0%,100%,.02);
        --theme-border-color: hsla(0,0%,100%,.2);
        --theme-shadow-color: hsla(0,0%,0%,.25);
        --theme-text-on-bg: #000000;
        --theme-text-shadow-on-bg: rgba(255,255,255,0.5);
        --theme-accent-shadow: transparent;
      }
      .dark:root {
        --text-main-color: #FFFFFF;
        --text-shadow-color: rgba(0,0,0,0.7);

        /* Dark AI Theme Variables (with defaults) */
        --theme-primary-bg: hsla(0,0%,0%,.3);
        --theme-highlight-bg: hsla(0,0%,100%,.06);
        --theme-gradient-start: hsla(0,0%,10%,.25);
        --theme-gradient-end: hsla(0,0%,0%,.35);
        --theme-border-color: hsla(0,0%,100%,.12);
        --theme-shadow-color: hsla(0,0%,0%,.45);
        --theme-text-on-bg: #FFFFFF;
        --theme-text-shadow-on-bg: rgba(0,0,0,0.7);
        --theme-accent-shadow: transparent;
      }

      #system-background {
        position: fixed;
        inset: 0;
        z-index: -1;
        background-size: cover;
        background-position: center;
        transition: background-image 0.5s ease-in-out, background-color 0.5s ease-in-out;
      }

      /* --- NEW START MENU ANIMATIONS --- */
      @keyframes startMenuEnter {
        from {
          opacity: 0;
          transform: translate(-50%, 20px) scale(0.95);
          filter: blur(5px);
        }
        70% {
          opacity: 1;
          transform: translate(-50%, -5px) scale(1.02);
          filter: blur(0px);
        }
        to {
          opacity: 1;
          transform: translate(-50%, 0) scale(1);
          filter: blur(0);
        }
      }
      .animate-start-menu-enter {
        animation: startMenuEnter 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
      }

      @keyframes startMenuExit {
        from {
          opacity: 1;
          transform: translate(-50%, 0) scale(1);
          filter: blur(0);
        }
        to {
          opacity: 0;
          transform: translate(-50%, 20px) scale(0.95);
          filter: blur(5px);
        }
      }
      .animate-start-menu-exit {
        animation: startMenuExit 0.3s cubic-bezier(0.4, 0, 1, 1) forwards;
      }
      /* --- END NEW START MENU ANIMATIONS --- */


      /* --- UPDATED LIQUID WINDOW ANIMATIONS --- */
      @keyframes windowEnter {
        from {
          opacity: 0;
          transform: scale(0.9);
          filter: blur(5px);
        }
        70% {
          opacity: 1;
          transform: scale(1.02);
          filter: blur(0);
        }
        to {
          opacity: 1;
          transform: scale(1);
          filter: blur(0);
        }
      }
      .animate-window-enter {
        animation: windowEnter 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
      }

      @keyframes windowExit {
        from {
          opacity: 1;
          transform: scale(1);
          filter: blur(0);
        }
        to {
          opacity: 0;
          transform: scale(0.95);
          filter: blur(10px);
        }
      }
      .animate-window-exit {
        animation: windowExit 0.3s cubic-bezier(0.4, 0, 1, 1) forwards;
      }

      @keyframes windowMinimize {
        from {
          opacity: 1;
          transform: scale(1);
        }
        to {
          opacity: 0;
          transform: scale(0.85);
        }
      }
      .animate-window-minimize {
        animation: windowMinimize 0.3s cubic-bezier(0.4, 0, 0.2, 1) forwards;
      }
      
      @keyframes windowRestore {
        from {
          opacity: 0;
          transform: scale(0.85);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }
      .animate-window-restore {
        animation: windowRestore 0.3s cubic-bezier(0.4, 0, 0.2, 1) forwards;
      }
      
      .window-transform-transition {
        transition-property: top, left, width, height;
        transition-duration: 400ms;
        transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
      }
      /* --- END UPDATED WINDOW ANIMATIONS --- */


      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
      }
      .animate-fade-in {
        animation: fadeIn 0.8s ease-in-out forwards;
        opacity: 0;
      }
      .delay-1 { animation-delay: 0.2s; }
      .delay-2 { animation-delay: 0.4s; }
      .delay-3 { animation-delay: 0.6s; }
      
      @keyframes fadeInRight {
        from {
          opacity: 0;
          transform: translateX(20px) translateY(-50%);
        }
        to {
          opacity: 1;
          transform: translateX(0) translateY(-50%);
        }
      }
      .animate-fade-in-right {
        animation: fadeInRight 0.3s ease-out forwards;
      }

      @keyframes fadeInUp {
        from { opacity: 0; transform: translate(0, 10px) scale(0.98); }
        to { opacity: 1; transform: translate(0, 0) scale(1); }
      }
      .animate-fade-in-up {
        animation: fadeInUp 0.2s ease-out forwards;
      }
      
      @keyframes spin-slow {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
      }
      .animate-spin-slow {
        animation: spin-slow 1.5s linear infinite;
        transform-origin: center;
      }
      
      @keyframes pulse {
        50% {
          opacity: .5;
        }
      }
      
      /* --- FROSTED GLASS STYLES (MODIFIED FOR LIGHT EDGE) --- */
      .taskbar-background {
        background: 
          radial-gradient(ellipse 80% 70% at 20% 15%, hsla(0,0%,100%,.1), transparent),
          linear-gradient(145deg, hsla(0,0%,100%,.08) 0%, hsla(0,0%,100%,.02) 100%);
        border: 1px solid hsla(0,0%,100%,.2);
        backdrop-filter: blur(48px);
        -webkit-backdrop-filter: blur(48px);
        box-shadow: 
          inset 0 0 25px -5px hsla(220, 100%, 85%, 0.1),
          0 16px 48px hsla(0,0%,0%,.25);
        transition: background-color 0.5s ease, background-image 0.5s ease, border-color 0.5s ease, box-shadow 0.5s ease;
      }
      
      .window-background {
        background: 
          radial-gradient(ellipse 80% 70% at 20% 15%, hsla(0,0%,100%,.1), transparent),
          linear-gradient(145deg, hsla(0,0%,100%,.08) 0%, hsla(0,0%,100%,.02) 100%);
        border: 1px solid hsla(0,0%,100%,.2);
        backdrop-filter: blur(48px);
        -webkit-backdrop-filter: blur(48px);
        box-shadow: 
          inset 0 0 25px -5px hsla(220, 100%, 85%, 0.1),
          inset 0 0 0 0 hsla(0,0%,100%,0), /* Placeholder for transition */
          0 16px 48px hsla(0,0%,0%,.25);
        transition: background-color 0.5s ease, background-image 0.5s ease, border-color 0.5s ease, box-shadow 0.3s ease;
      }
      .window-focused.window-background {
        box-shadow: 
          inset 0 0 25px -5px hsla(220, 100%, 85%, 0.1),
          inset 0 0 2px 1px hsla(0,0%,100%,.3), /* Visible light edge */
          0 20px 55px hsla(0,0%,0%,.3); /* Slightly larger shadow when focused */
      }
      
      .dark .taskbar-background {
        background: 
          radial-gradient(ellipse 80% 70% at 20% 15%, hsla(0,0%,100%,.06), transparent),
          linear-gradient(145deg, hsla(0,0%,10%,.25) 0%, hsla(0,0%,0%,.35) 100%);
        border: 1px solid hsla(0,0%,100%,.12);
        box-shadow: 
          inset 0 0 30px -5px hsla(220, 90%, 70%, 0.1),
          0 24px 70px hsla(0,0%,0%,.45);
      }
      
      .dark .window-background {
        background: 
          radial-gradient(ellipse 80% 70% at 20% 15%, hsla(0,0%,100%,.06), transparent),
          linear-gradient(145deg, hsla(0,0%,10%,.25) 0%, hsla(0,0%,0%,.35) 100%);
        border: 1px solid hsla(0,0%,100%,.12);
        box-shadow: 
          inset 0 0 30px -5px hsla(220, 90%, 70%, 0.1),
          inset 0 0 0 0 hsla(0,0%,100%,0),
          0 24px 70px hsla(0,0%,0%,.45);
      }
      .dark .window-focused.window-background {
          box-shadow: 
            inset 0 0 30px -5px hsla(220, 90%, 70%, 0.1),
            inset 0 0 2px 1px hsla(0,0%,100%,.15),
            0 28px 80px hsla(0,0%,0%,.5);
      }
      
      /* --- THEME STYLES (OVERRIDE) --- */
      .theme-active .window-background,
      .theme-active .taskbar-background {
        background-color: var(--theme-primary-bg);
        background-image: 
          radial-gradient(ellipse 80% 70% at 20% 15%, var(--theme-highlight-bg, transparent), transparent),
          linear-gradient(145deg, var(--theme-gradient-start, transparent) 0%, var(--theme-gradient-end, transparent) 100%);
        border: 1px solid var(--theme-border-color);
        box-shadow: 
          inset 0 0 40px -10px var(--theme-accent-shadow),
          0 16px 48px var(--theme-shadow-color);
      }
      /* --- END FROSTED GLASS STYLES --- */


      /* --- Light Field Button Styles --- */
      .light-field-button {
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 20px; /* Increased roundness */
        border: 1.5px solid transparent;
        background-clip: padding-box;
        background-image: 
          linear-gradient(140deg, hsla(0,0%,100%,.1), hsla(0,0%,100%,.02)),
          linear-gradient(140deg, hsla(0,0%,100%,.3), hsla(0,0%,100%,.1));
        backdrop-filter: blur(24px);
        -webkit-backdrop-filter: blur(24px);
        box-shadow: 
          0 8px 24px hsla(0,0%,0%,.2),
          inset 0 1.5px 1px hsla(0,0%,100%,.5),
          inset 0 -1px 1px hsla(0,0%,0%,.2);
        transition: all 0.25s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        -webkit-tap-highlight-color: transparent;
        outline: none;
        overflow: hidden;
      }

      .dark .light-field-button {
        background-image: 
          linear-gradient(140deg, hsla(0,0%,15%,.4), hsla(0,0%,5%,.5)),
          linear-gradient(140deg, hsla(0,0%,100%,.15), hsla(0,0%,100%,.05));
        box-shadow: 
          0 10px 30px hsla(0,0%,0%,.35),
          inset 0 1.5px 1px hsla(0,0%,100%,.1),
          inset 0 -1px 1px hsla(0,0%,0%,.4);
      }

      .light-field-button::before {
        content: '';
        position: absolute;
        top: 0;
        left: -150%;
        width: 75%;
        height: 100%;
        background: linear-gradient(
          to right,
          transparent 0%,
          hsla(0,0%,100%,.3) 50%,
          transparent 100%
        );
        transform: skewX(-25deg);
        transition: left 0.9s cubic-bezier(0.23, 1, 0.32, 1);
      }
      
      .dark .light-field-button::before {
        background: linear-gradient( to right, transparent 0%, hsla(0,0%,100%,.15) 50%, transparent 100%);
      }
      
      .light-field-button:hover::before {
        left: 150%;
      }

      .light-field-button:hover {
        transform: translateY(-5px) scale(1.03);
        background-image: 
          linear-gradient(140deg, hsla(0,0%,100%,.15), hsla(0,0%,100%,.05)),
          linear-gradient(140deg, hsla(0,0%,100%,.4), hsla(0,0%,100%,.2));
        box-shadow: 
          0 16px 32px hsla(0,0%,0%,.25),
          inset 0 2px 1.5px hsla(0,0%,100%,.7),
          inset 0 -1.5px 1.5px hsla(0,0%,0%,.25);
      }
      
      .dark .light-field-button:hover {
        background-image: 
          linear-gradient(140deg, hsla(0,0%,20%,.4), hsla(0,0%,8%,.5)),
          linear-gradient(140deg, hsla(0,0%,100%,.2), hsla(0,0%,100%,.1));
        box-shadow: 
          0 16px 40px hsla(0,0%,0%,.4),
          inset 0 2px 1.5px hsla(0,0%,100%,.15),
          inset 0 -1.5px 1.5px hsla(0,0%,0%,.5);
      }
      
      .light-field-button:focus-visible {
        outline: 2px solid #818cf8;
        outline-offset: 3px;
      }

      .light-field-button:active {
        transform: scale(0.92); /* Jelly press effect */
        box-shadow: inset 0 3px 7px hsla(0,0%,0%,.4); /* Deeper inset shadow */
        transition: transform 0.05s cubic-bezier(0.4, 0, 1, 1), box-shadow 0.05s cubic-bezier(0.4, 0, 1, 1);
      }
      
      .dark .light-field-button:active {
        box-shadow: inset 0 4px 8px hsla(0,0%,0%,.6);
      }
      
      .theme-active .light-field-button {
        background-image: linear-gradient(140deg, var(--theme-gradient-start, transparent), var(--theme-gradient-end, transparent));
      }

      /* --- Light Field Effect --- */
      .light-field-container {
        position: relative;
        overflow: hidden; /* Contain the light effect */
        -webkit-tap-highlight-color: transparent; /* For touch devices */
      }

      .light-field-container::before {
        content: '';
        position: absolute;
        /* Use CSS variables set by the hook */
        left: var(--light-x, 50%);
        top: var(--light-y, 50%);
        transform: translate(-50%, -50%);
        
        width: 350px; /* The radius of the light effect */
        height: 350px;
        
        /* The light itself: a soft white radial gradient */
        background-image: radial-gradient(
          circle at center,
          hsla(0, 0%, 100%, 0.25) 0%,
          hsla(0, 0%, 100%, 0) 50%
        );
        
        /* Use opacity for smooth fade-in/out */
        opacity: var(--light-opacity, 0);
        transition: opacity 0.4s cubic-bezier(0.25, 1, 0.5, 1);
        
        /* Ensure the light effect doesn't block interactions with buttons */
        pointer-events: none;
        z-index: 1; /* Position it above button backgrounds */
      }
      
      .dark .light-field-container::before {
          background-image: radial-gradient(
              circle at center,
              hsla(0, 0%, 100%, 0.15) 0%,
              hsla(0, 0%, 100%, 0) 50%
          );
      }
      /* --- END Light Field Effect --- */


      /* --- CUSTOM TEXT STYLE --- */
      .text-outline {
        color: var(--text-main-color);
        text-shadow: 0 1px 2px var(--text-shadow-color), 0 0 2px var(--text-shadow-color);
        transition: color 0.5s ease, text-shadow 0.5s ease;
      }
      .placeholder-outline::placeholder {
        color: #d1d5db; /* gray-300 */
        text-shadow: 0 1px 2px var(--text-shadow-color), 0 0 2px var(--text-shadow-color);
        opacity: 1;
      }
      .theme-active .text-outline {
        color: var(--theme-text-on-bg);
        text-shadow: 0 1px 2px var(--theme-text-shadow-on-bg);
      }
      .theme-active .placeholder-outline::placeholder {
        color: var(--theme-text-on-bg);
        opacity: 0.6;
      }
      
      /* Color Immersion Effect */
      .theme-active .light-field-button img {
        transition: filter 0.5s ease-in-out;
        filter: drop-shadow(0 2px 3px var(--theme-accent-shadow, transparent));
      }

      /* --- WIDGET STYLES --- */
      @keyframes widget-drop-bounce {
        0% {
          opacity: 0;
          transform: translateY(-30px) scale(0.9);
        }
        60% {
          opacity: 1;
          transform: translateY(5px) scale(1.05);
        }
        80% {
          transform: translateY(-2px) scale(0.98);
        }
        100% {
          opacity: 1;
          transform: translateY(0) scale(1);
        }
      }
      .animate-widget-drop {
        animation: widget-drop-bounce 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
      }
      .widget-panel {
        transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        transform: translateX(-100%);
      }
      .widget-panel.open {
        transform: translateX(0);
      }
      .widget-preview {
        cursor: grab;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
      }
      .widget-preview:hover {
        transform: scale(1.05);
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
      }
      .widget-preview:active {
        cursor: grabbing;
        transform: scale(1.02);
      }
      .desktop-widget-wrapper {
        transition: opacity 0.2s ease;
      }

      /* --- INFORMATION STATION STYLES --- */
      .information-station {
        transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        transform: translateX(100%);
      }
      .information-station.open {
        transform: translateX(0);
      }
      .drop-target-active {
        outline: 2px dashed #3b82f6; /* blue-500 */
        outline-offset: -4px;
        background-color: rgba(59, 130, 246, 0.1);
      }

      /* --- AI GRADIENT BORDER --- */
      .ai-gradient-border {
        position: relative;
        z-index: 0;
      }
      .ai-gradient-border::before {
        content: '';
        position: absolute;
        z-index: -1;
        inset: -3px; /* Controls border thickness */
        border-radius: inherit; /* Match parent's border-radius */
        padding: 3px; /* Same as inset to create the border effect */
        background: linear-gradient(60deg, #f79533, #f37055, #ef4e7b, #a166ab, #5073b8, #1098ad, #07b39b, #6fba82);
        background-size: 400% 400%;
        animation: ai-gradient-animation 6s ease infinite;
        -webkit-mask: 
          linear-gradient(#fff 0 0) content-box, 
          linear-gradient(#fff 0 0);
        mask: 
          linear-gradient(#fff 0 0) content-box, 
          linear-gradient(#fff 0 0);
        -webkit-mask-composite: xor;
                mask-composite: exclude;
      }

      @keyframes ai-gradient-animation {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
      }
      
      /* --- RIPPLE EFFECT (MODIFIED FOR GLOW) --- */
      @keyframes ripple {
        to {
          transform: scale(4);
          opacity: 0;
        }
      }
      .ripple {
        position: absolute;
        border-radius: 50%;
        transform: scale(0);
        animation: ripple 600ms linear;
        background-image: radial-gradient(circle, hsla(0,0%,100%,.7) 0%, hsla(0,0%,100%,.3) 40%, transparent 70%);
        box-shadow: 0 0 10px hsla(0,0%,100%,.5), 0 0 20px hsla(0,0%,100%,.3);
        pointer-events: none;
      }

      /* --- PARTICLE EFFECT --- */
      .particle {
        position: fixed;
        width: 6px;
        height: 6px;
        border-radius: 50%;
        pointer-events: none;
        background: white;
        box-shadow: 0 0 8px white, 0 0 12px #818cf8, 0 0 16px #818cf8;
        z-index: 9999;
        animation: particle-burst 0.7s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
      }
      @keyframes particle-burst {
          from {
              transform: translate(-50%, -50%) scale(1);
              opacity: 1;
          }
          to {
              transform: translate(var(--translateX), var(--translateY)) scale(0);
              opacity: 0;
          }
      }
      
      /* --- SNAP LAYOUTS POPUP --- */
      .snap-popup {
        position: absolute;
        top: 100%;
        left: 50%;
        transform: translateX(-50%);
        background: var(--theme-primary-bg, hsla(0,0%,0%,.6));
        backdrop-filter: blur(24px);
        -webkit-backdrop-filter: blur(24px);
        border: 1px solid var(--theme-border-color, hsla(0,0%,100%,.2));
        border-radius: 8px;
        padding: 8px;
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 8px;
        z-index: 100;
        box-shadow: 0 8px 24px hsla(0,0%,0%,.4);
      }
      .dark .snap-popup {
        background: var(--theme-primary-bg, hsla(0,0%,10%,.7));
      }
      .snap-layout {
        width: 80px;
        height: 50px;
        background: hsla(0,0%,50%,.2);
        border-radius: 4px;
        display: flex;
        gap: 2px;
        padding: 2px;
        cursor: pointer;
      }
      .snap-area {
        background: hsla(0,0%,50%,.3);
        border: 1px solid transparent;
        flex-grow: 1;
        border-radius: 2px;
        transition: background-color 0.2s, border-color 0.2s;
      }
      .snap-layout:hover .snap-area {
        background-color: hsla(210, 100%, 70%, 0.3);
      }
      .snap-area:hover {
        background-color: hsla(210, 100%, 60%, 0.6) !important;
        border-color: hsla(210, 100%, 80%, 0.8);
      }
      .layout-thirds {
          flex-direction: row;
      }
      .layout-quarters {
          display: grid;
          grid-template-columns: 1fr 1fr;
          grid-template-rows: 1fr 1fr;
      }
      .layout-main-side {
          flex-direction: row;
      }
      .snap-area.main {
          flex-basis: 66%;
      }
      .snap-area.side {
          flex-basis: 33%;
      }

      /* --- SNAP GROUP PREVIEW --- */
      .snap-group-preview {
        position: absolute;
        bottom: 100%;
        left: 50%;
        transform: translateX(-50%);
        margin-bottom: 8px;
        width: 180px;
        height: 100px;
        background: var(--theme-primary-bg, hsla(0,0%,10%,.7));
        backdrop-filter: blur(24px);
        -webkit-backdrop-filter: blur(24px);
        border: 1px solid var(--theme-border-color, hsla(0,0%,100%,.2));
        border-radius: 8px;
        padding: 4px;
        z-index: 100;
        box-shadow: 0 8px 24px hsla(0,0%,0%,.4);
        cursor: pointer;
      }
      .snap-group-preview-window {
        position: absolute;
        background: hsla(210, 100%, 70%, 0.3);
        border: 1px solid hsla(210, 100%, 80%, 0.8);
        border-radius: 2px;
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
      }
      .snap-group-preview-window img {
        width: 16px;
        height: 16px;
        opacity: 0.8;
      }

    </style>
  <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.1.0",
    "react-dom/": "https://esm.sh/react-dom@^19.1.0/",
    "react/": "https://esm.sh/react@^19.1.0/",
    "@google/genai": "https://esm.sh/@google/genai",
    "firebase/app": "https://esm.sh/firebase@10.12.2/app",
    "firebase/auth": "https://esm.sh/firebase@10.12.2/auth",
    "firebase/firestore": "https://esm.sh/firebase@10.12.2/firestore",
    "uuid": "https://esm.sh/uuid@9.0.1",
    "html2canvas": "https://esm.sh/html2canvas@1.4.1"
  }
}
</script>
</head>
  <body>
    <div id="system-background"></div>
    <div id="root"></div>
    <script type="module" src="/index.tsx"></script>
  </body>
</html>